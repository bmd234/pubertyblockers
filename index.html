<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Puberty Blockers Educational Flowchart</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    const flowchartNodes = [
      { id: "puberty-blockers", label: "PUBERTY BLOCKERS", level: 1 },
      { id: "who-uses-them", label: "WHO USES THEM?", level: 2 },
      { id: "are-they-safe", label: "ARE THEY SAFE?", level: 2 },
      { id: "how-do-they-work", label: "HOW DO THEY WORK?", level: 2 },
      { id: "social-effects", label: "SOCIAL EFFECTS", level: 3 },
      { id: "criteria-prescription", label: "CRITERIA FOR PRESCRIPTION", level: 3 },
      { id: "physical-effects", label: "PHYSICAL EFFECTS", level: 3 },
      { id: "lt-side-effects", label: `LONG-TERM\nSIDE EFFECTS`, level: 5 },
      { id: "st-side-effects", label: `SHORT-TERM\nSIDE EFFECTS`, level: 3 },
      { id: "will-child-regret", label: "WILL MY CHILD REGRET IT?", level: 3 },
      { id: "types-blockers", label: "TYPES OF BLOCKERS", level: 3 },
      { id: "next-steps", label: "NEXT STEPS", level: 3 },
      { id: "how-administered", label: "HOW IS IT ADMINISTERED?", level: 3 },
      { id: "where-how-get", label: "WHERE/HOW DO I GET THEM?", level: 4 },
      { id: "changes-permanent", label: "ARE THE CHANGES PERMANENT?", level: 4 },
      { id: "managing-side-effects", label: "MANAGING SIDE EFFECTS", level: 4 },
      { id: "other-options", label: "OTHER OPTIONS", level: 4 },
      { id: "how-frequently", label: "HOW FREQUENTLY?", level: 4 }
    ];

    const contentSections = [
      {
        id: "puberty-blockers",
        title: "PUBERTY BLOCKERS",
        content: {
          bullets: [
            "Navigating gender-affirming care can be complex, overwhelming, and at times, even feel frightening. That’s why our team is here to support you by answering any questions you may have about the purpose, mechanisms, effects, and safety of Puberty Blockers.",
            "To use the flowchart, click on the questions that are most relevant to you to gain a clearer understanding of the care provided through puberty blockers."
          ]
        }
      },
      {
        id: "who-uses-them",
        title: "WHO USES THEM?",
        content: {
          text: "Most people who utilize puberty blockers have begun puberty and:",
          bullets: [
            "Exhibit gender non-conformity or gender dysphoria",
            "Have gender dysphoria that began or worsened as puberty onset"
          ]
        }
      },
      {
        id: "are-they-safe",
        title: "ARE THEY SAFE?",
        content: {
          bullets: [
            "Puberty Blockers have been used safely for decades to treat early puberty, endometriosis, & other diagnoses.",
            "Professional societies endorse puberty blockers for youth with gender dysphoria"
          ]
        }
      },
      {
        id: "how-do-they-work",
        title: "HOW DO THEY WORK?",
        content: {
          bullets: [
            "'Puberty Blockers' is another way to say 'Gonadotropin-Releasing Hormone (GnRH) Analogues'",
            "Puberty Blockers mimic the natural hormone, GnRH, in the body. They act like natural GnRH, but overstimulate hormone receptors. This reduces the production of sex hormones like estrogen and testosterone!"
          ]
        }
      },
      {
        id: "social-effects",
        title: "SOCIAL EFFECTS",
        content: {
          bullets: [
            "Puberty Blockers may allow for youth to find comfort and satisfaction in their own body instead of feeling the discomfort that transgender children often feel when undergoing puberty.",
            "Commonly, transgender people want to be recognized by others as their identified gender, and to not have their gender misclassified by others. Puberty Blockers limit misperception and misgendering, allowing social interactions to be validating rather than exclusionary."
          ]
        }
      },
      {
        id: "criteria-prescription",
        title: "CRITERIA FOR PRESCRIPTION",
        content: {
          bullets: [
            "Has a diagnosis of persistent, well-documented gender dysphoria or incongruence from trained providers.",
            "Has had a review of co-existing conditions by healthcare providers.",
            "Risks, complications, and benefits have been discussed in detail.", 
            "Consent has been given by the patient and their guardians."
          ]
        }
      },
      {
        id: "physical-effects",
        title: "PHYSICAL EFFECTS",
        layout: "image",
        content: {
          title: "PHYSICAL EFFECTS",
          extraImage: "physical effects.jpg", // ✅ Added this line
          left: {
            subtitle: "ASSIGNED FEMALE AT BIRTH",
            image: "female.png",
            infoboxes: [
              "Prevents development of sex drive",
              "Stops breast development",
              "Stops menstruation*",
              "Prevents hip broadening"
            ]
          },
          right: {
            subtitle: "ASSIGNED MALE AT BIRTH",
            image: "male.png",
            infoboxes: [
              "Prevents development of sex drive",
              "Slows growth of facial & body hair",
              "Prevents broadening of shoulders",
              "Limits growth of Adam’s Apple & prevents voice deepening",
              "Limits penis, scrotum, & testicle growth"
            ]
          }
        }
      },
      {
        id: "st-side-effects",
        title: "SHORT-TERM SIDE EFFECTS",
        content: {
          bullets: [
            "Swelling at the site of the shot",
            "Weight gain",
            "Hot flashes",
            "Headaches",
            "Mood changes"
          ]
        }
      },
      {
        id: "lt-side-effects",
        title: "LONG-TERM SIDE EFFECTS",
        content: {
          bullets: [
            "May affect growth spurts, bone growth, or bone density",
            "Possible effects on fertility depending on when started"
          ]
        }
      },
      {
        id: "will-child-regret",
        title: "WILL MY CHILD REGRET IT?",
        content: {
          bullets: [
            "If your child stops taking Puberty Blockers, puberty resumes.",
            "Less than 5% of trans teens report regret regarding puberty blockers."
          ]
        }
      },
      {
        id: "types-blockers",
        title: "TYPES OF BLOCKERS",
        content: {
          bullets: [
            "A flexible rod called histrelin acetate lasts for 1 year.",
            "An injection called leuprolide acetate works for 1–4 months at a time."
          ]
        }
      },
      {
        id: "next-steps",
        title: "NEXT STEPS",
        content: {
          bullets: [
            "Youth may discontinue blockers to allow puberty to continue.",
            "They may also transition to hormone replacement therapy around 16."
          ]
        }
      }
    ];

    const FlowchartButton = ({ node, isActive, onClick }) => {
      const colorClasses = isActive
        ? "bg-purple-700 hover:bg-purple-800"
        : "bg-gray-400 hover:bg-gray-500";
      return (
        <button
          className={`px-3 py-2 rounded-full font-medium text-white text-xs transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-400 ${colorClasses}`}
          onClick={() => onClick(node.id)}
        >
          {node.label}
        </button>
      );
    };

    const SymmetricGrid = ({ data }) => {
      const { title, left, right, extraImage } = data;
      const processBoxes = (boxes) => {
        const grid = Array(6).fill(null);
        const outer = [0, 1, 2];
        const inner = [5, 4, 3];
        let i = 0;
        for (const idx of [...outer, ...inner]) {
          if (i < boxes.length) {
            grid[idx] = boxes[i];
            i++;
          }
        }
        return grid;
      };
      const BoxGrid = ({ boxes }) => {
        const grid = processBoxes(boxes);
        return (
          <div className="grid grid-rows-3 grid-cols-2 gap-2 w-40">
            {grid.map((box, idx) => (
              <div key={idx} className={`rounded-lg p-2 text-sm text-white h-16 flex items-center justify-center ${box ? 'bg-purple-500' : 'invisible'}`}>
                {box}
              </div>
            ))}
          </div>
        );
      };
      return (
        <div className="flex flex-col items-center gap-6">
          <h1 className="text-3xl font-bold">{title}</h1>
          {extraImage && (
            <img
              src={extraImage}
              alt="Physical Effects Overview"
              className="w-96 rounded-2xl shadow-lg mb-4"
            />
          )}
          <div className="flex flex-row justify-center items-start gap-12">
            <div className="flex flex-row-reverse gap-4 items-start">
              <img src={left.image} alt={left.subtitle} className="w-40 h-40 object-cover rounded-lg" />
              <div className="flex flex-col items-end">
                <h2 className="text-lg font-semibold mb-2">{left.subtitle}</h2>
                <BoxGrid boxes={left.infoboxes} />
              </div>
            </div>
            <div className="flex flex-row gap-4 items-start">
              <img src={right.image} alt={right.subtitle} className="w-40 h-40 object-cover rounded-lg" />
              <div className="flex flex-col items-start">
                <h2 className="text-lg font-semibold mb-2">{right.subtitle}</h2>
                <BoxGrid boxes={right.infoboxes} />
              </div>
            </div>
          </div>
        </div>
      );
    };

    const ContentDisplay = ({ content }) => {
      if (!content)
        return <div className="bg-red-100 text-red-700 p-6 rounded-xl text-center">Content unavailable.</div>;
      return (
        <div className="bg-purple-700 text-white p-8 rounded-3xl max-w-4xl mx-auto mt-8">
          <h2 className="text-3xl font-bold mb-6 text-center">{content.title}</h2>
          {content.layout === "image" ? (
            <SymmetricGrid data={content.content} />
          ) : (
            <>
              {content.content.text && <p className="text-lg mb-4">{content.content.text}</p>}
              {content.content.bullets && (
                <ul className="list-disc list-inside space-y-2 text-lg">
                  {content.content.bullets.map((b, i) => <li key={i}>{b}</li>)}
                </ul>
              )}
            </>
          )}
        </div>
      );
    };

    const FlowchartDiagram = ({ activeNodeId, onNodeClick }) => {
      const topMap = {1: 64, 2: 160, 3: 320, 4: 512, 5: 416};
      const posMap = {"puberty-blockers":50,"who-uses-them":20,"are-they-safe":50,"how-do-they-work":80,"social-effects":2,"criteria-prescription":15,"physical-effects":29,"lt-side-effects":43,"st-side-effects":43,"will-child-regret":59,"types-blockers":74,"next-steps":85,"how-administered":96};
      const getCoords = id => {
        const x = (posMap[id] / 100) * 1000;
        const y = topMap[flowchartNodes.find(n => n.id === id).level];
        return { x, y };
      };
      const arrows = [
        ["puberty-blockers","who-uses-them"],
        ["puberty-blockers","are-they-safe"],
        ["puberty-blockers","how-do-they-work"],
        ["who-uses-them","physical-effects"],
        ["physical-effects","lt-side-effects"],
        ["how-do-they-work","next-steps"]
      ];
      return (
        <div className="relative mb-12 p-8 min-h-[600px] max-w-7xl mx-auto">
          <svg className="absolute inset-0 w-full h-full z-0" viewBox="0 0 1000 600" preserveAspectRatio="none">
            {arrows.map(([fromId,toId],i)=>{
              const f=getCoords(fromId);const t=getCoords(toId);
              return <line key={i} x1={f.x} y1={f.y+20} x2={t.x} y2={t.y-20} stroke="gray" strokeWidth="2" markerEnd="url(#arrowhead)" />;
            })}
            <defs>
              <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="gray" />
              </marker>
            </defs>
          </svg>
          {flowchartNodes.map(node=>{
            const topClass=`top-[${topMap[node.level]}px]`;
            const leftClass=`left-[${posMap[node.id]}%] transform -translate-x-1/2`;
            return (
              <div key={node.id} className={`absolute ${topClass} ${leftClass} z-10`}>
                <FlowchartButton node={node} isActive={activeNodeId===node.id} onClick={onNodeClick}/>
              </div>
            );
          })}
        </div>
      );
    };

    const FlowchartApp = () => {
      const [activeNodeId, setActiveNodeId] = useState("puberty-blockers");
      const activeContent = contentSections.find(s => s.id === activeNodeId);
      return (
        <div className="min-h-screen py-8 px-4 bg-gray-50">
          <div className="max-w-7xl mx-auto">
            <FlowchartDiagram activeNodeId={activeNodeId} onNodeClick={setActiveNodeId}/>
            <ContentDisplay content={activeContent}/>
          </div>
        </div>
      );
    };

    ReactDOM.render(<FlowchartApp />, document.getElementById("root"));
  </script>
</body>
</html>
